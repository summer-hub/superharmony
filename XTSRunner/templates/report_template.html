<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:str="http://exslt.org/strings" xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title>Test Results &mdash; {original_name}</title>
        <style type="text/css">
          html {{ height: 100% }}
          body {{
            margin: 0 auto;
            padding: 0;
            text-align: left;
            height: 100%;
            font-family: myriad, arial, tahoma, verdana, sans-serif;
            color: #151515;
            font-size: 90%;
            line-height: 1.3em;
            background-color: #fff;
          }}
          * {{ margin: 0; padding: 0 }}
          .clr {{ clear: both; overflow: hidden; }}
          img {{ border: none }}
          a {{ color: #0046b0; text-decoration: none; }}
          a:hover {{ text-decoration: none; }}
          a:focus, a:active {{ outline: none }}
          .noborder {{ border: none }}
          h1 {{
            color: #151515;
            font-size: 180%;
            line-height: 1.1em;
            font-weight: bold;
          }}
          h2 {{
            color: #393D42;
            font-size: 160%;
            font-weight: normal
          }}
          h3 {{
            font-size: 120%;
            font-weight: bold;
            margin-bottom: .5em
          }}
          h4 {{ font-size: 110%; }}
          h5 {{ font-size: 110%; }}
          span.failed {{ color: #ff0000 }}
          span.error {{ color: #ff0000 }}
          span.passed {{ color: #1d9d01 }}
          span.ignored {{ color: #fff600 }}
          span.skipped {{ color: #fff600 }}
          hr {{ background-color: blue }}
          #container {{ min-width: 30em; }}
          #header {{
            padding: 0;
            position: fixed;
            width: 100%;
            z-index: 10;
            background-color: #c7ceda;
          }}
          #header h1 {{ margin: 1em 3em 1em 1.7em; }}
          #header h1 strong {{ white-space: nowrap; }}
          #header .time {{
            margin-top: 2.2em;
            margin-right: 3.4em;
            float: right;
          }}
          #content {{
            margin: 0;
            padding: .5em 3em .5em 0;
            text-align: left;
            background-color: #fff;
            padding-top: 80px; /* 增加顶部内边距，确保内容不被固定的header遮挡 */
          }}
          #content ul {{
            margin: .4em 0 .1em 2em;
            list-style: none;
          }}
          #content ul li.level {{
            cursor: pointer;
          }}
          #content ul li.level span {{
            display: block;
            font-weight: bold;
            position: relative;
          }}
          #content ul li.level.top {{
            margin-bottom: .3em;
          }}
          #content ul li.level.top > span {{
            padding: .5em 0 .5em 1em;
            font-size: 120%;
            color: #151515;
            background-color: #f2f2f2;
            border-left: solid 10px #93e078;
          }}
          #content ul li.level.top.failed > span {{
            border-left: solid 10px #f02525;
          }}
          #content ul li.level.suite > span {{
            margin-bottom: .8em;
            padding: 0 0 0 .8em;
            display: block;
            font-size: 110%;
            line-height: 1em;
            color: #151515;
            border-left: solid 15px #93e078;
          }}
          #content ul li.level.suite.failed > span {{
            border-left: solid 15px #f02525;
          }}
          #content ul li.level.test {{
            margin-bottom: .5em;
          }}
          #content ul li.level.test > span {{
            padding: .3em 0 .3em 1em;
            color: #0046b0;
            font-size: 100%;
            border-left: solid 6px #93e078;
            border-bottom: solid 1px #dbdbdb;
          }}
          #content ul li.level.test.failed > span {{
            border-left: solid 6px #f02525;
          }}
          #content ul li .time {{
            margin-right: .5em;
            width: 5em;
            text-align: right;
            font-size: 13px;
            color: #151515;
            font-style: normal;
            font-weight: normal;
            position: absolute;
            right: 7em;
            top: 50%;
            transform: translateY(-50%);
          }}
          #content ul li .status {{
            width: 6em;
            font-size: 90%;
            font-style: normal;
            font-weight: normal;
            position: absolute;
            right: 0;
            top: 50%;
            transform: translateY(-50%);
          }}
          /* 设置状态颜色 */
          #content ul li .status {{
            color: #1d9d01; /* 默认为通过颜色 */
          }}
          
          #content ul li.failed .status {{
            color: #ff0000; /* 失败状态为红色 */
          }}
          
          /* 确保错误堆栈正确显示 */
          .error-stack {{
            margin-left: 20px;
            padding: 10px;
            background-color: #fff3f3;
            border-left: 3px solid #f02525;
            font-family: monospace;
            white-space: pre-wrap;
            margin-bottom: 10px;
            font-size: 12px;
            color: #333;
            display: block; /* 确保显示 */
          }}
          
          /* 添加控制按钮样式 */
          .controls {{
            margin: 10px 0;
            padding: 10px;
            background-color: #f5f5f5;
            border-radius: 4px;
            text-align: center;
          }}
          
          .controls button {{
            margin: 0 5px;
            padding: 5px 10px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
          }}
          
          .controls button:hover {{
            background-color: #45a049;
          }}
        </style>
        <script type="text/javascript">
        // 页面加载完成后立即执行的函数
        window.onload = function() {{
            // 展开所有测试结果
            var elements = document.getElementsByTagName('ul');
            for (var i = 0; i < elements.length; i++) {{
                elements[i].style.display = 'block';
            }}

            // 确保内容区域正好显示在标题栏下方
            var header = document.getElementById('header');
            var content = document.getElementById('content');
            if (header && content) {{
                content.style.paddingTop = (header.offsetHeight + 10) + 'px';
            }}
            
            // 自动展开失败的测试
            expandFailed();
            
            // 确保按钮事件绑定
            document.getElementById('expandAllBtn').onclick = expandAll;
            document.getElementById('collapseAllBtn').onclick = collapseAll;
            document.getElementById('expandFailedBtn').onclick = expandFailed;
        }};
        
        // 切换测试结果显示/隐藏
        function toggleTest(element) {{
            var parent = element.parentNode;
            var children = parent.getElementsByTagName('ul');
            for (var i = 0; i < children.length; i++) {{
                var child = children[i];
                if (child.style.display === 'none') {{
                    child.style.display = 'block';
                }} else {{
                    child.style.display = 'none';
                }}
            }}
        }}

        // 展开所有测试结果
        function expandAll() {{
            console.log("展开全部被点击");
            var elements = document.getElementsByTagName('ul');
            for (var i = 0; i < elements.length; i++) {{
                elements[i].style.display = 'block';
            }}
        }}

        // 折叠所有测试结果（保留顶层）
        function collapseAll() {{
            console.log("折叠全部被点击");
            var elements = document.getElementsByTagName('ul');
            for (var i = 1; i < elements.length; i++) {{ // Skip the first one
                elements[i].style.display = 'none';
            }}
        }}
        
        // 只展开失败的测试
        function expandFailed() {{
            console.log("只展开失败项被点击");
            // 先折叠所有
            collapseAll();
            
            // 然后展开失败的
            var failedElements = document.getElementsByClassName('failed');
            for (var i = 0; i < failedElements.length; i++) {{
                var parent = failedElements[i];
                // 确保父元素也是可见的
                while (parent && parent.tagName) {{
                    if (parent.tagName.toLowerCase() === 'li') {{
                        var uls = parent.getElementsByTagName('ul');
                        for (var j = 0; j < uls.length; j++) {{
                            uls[j].style.display = 'block';
                        }}
                    }
                    parent = parent.parentNode;
                }}
            }}
        }}
        </script>
    </head>
    <body>
        <div id="container">
            <div id="header">
                <div class="time">{total_time_s:.2f} s</div>
                <h1>
                    {original_name} 测试结果: <strong>{status_info}</strong>
                </h1>
            </div>
            <div id="content">
                <div class="controls">
                    <button id="expandAllBtn">展开全部</button>
                    <button id="collapseAllBtn">折叠全部</button>
                    <button id="expandFailedBtn">只展开失败项</button>
                </div>
                <ul id="tree">
                    <li class="level top {overall_status}">
                        <span onclick="toggleTest(this)"><em class="time">
                                <div class="time">{total_time_s:.2f} s</div>
                            </em>测试结果</span>
                        <ul>
                            {test_items}
                        </ul>
                    </li>
                </ul>
            </div>
            <div id="footer">
                <p>报告生成时间: {current_time}</p>
            </div>
        </div>
    </body>
</html>